(window.webpackJsonp=window.webpackJsonp||[]).push([[114],{597:function(e,a,s){"use strict";s.r(a);var t=s(20),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("©著作权归作者所有：来自51CTO博客作者梧桐0928的原创作品，如需转载，请注明出处，否则将追究法律责任"),s("br"),e._v("\nhttps://blog.51cto.com/songhl/2531799")]),e._v(" "),s("p",[e._v("本文讲述使用unixbench压测试file copy压测性能分析")]),e._v(" "),s("ol",[s("li",[e._v("安装unixbench软件")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("wget https://codeload.github.com/kdlucas/byte-unixbench/tar.gz/v5.1.3 \ntar zxvf v5.1.3\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("安装perf命令")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("-   Cent OS/RHEL：yum install perf\n-   Fedora：dnf install perf\n-   SUSE：zypper install perf\n-   Ubuntu：apt install linux-tools-common\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[e._v("3.使用perf记录unixbench性能热点函数  \n`perf -F 99 -a -g ./Run -c 8 fsdisk`  \nperf说明:  \n\\-F 为监控频率为1秒钟监控99次  \n\\-a 分析整个系统的性能  \n\\-g 记录函数简的调用关系  \nunixbench说明:  \n\\-c 使用8 core进行压测.  \nfsdisk 只压测file copy模式.  \n压测结果:  \n![](https://s4.51cto.com/images/blog/202009/11/e2e7ff918d73ca10ad381dbeeea5089a.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=)\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[s("p",[e._v("使用perf查看检测报告分析热点函数"),s("br"),e._v("\nperf report -n"),s("br"),e._v(" "),s("img",{attrs:{src:"https://s4.51cto.com/images/blog/202009/11/c49ff65c0eda5bfb0f71cef41a7d9386.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=",alt:""}})])]),e._v(" "),s("li",[s("p",[e._v("生产火焰图"),s("br"),e._v("\nFlameGrph地址： "),s("a",{attrs:{href:"https://github.com/brendangregg/FlameGraph",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/brendangregg/FlameGraph"),s("OutboundLink")],1),s("br"),e._v("\n下载软件:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("wget https://github.com/brendangregg/FlameGraph/archive/master.zip \nunzip master.zip \nexport PATH=$PATH:./FlameGraph-master\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("perf script -i perf.data > unixbench.perf stackcollapse-perf.pl unixbench.perf >unixbench.folded \nflamegraph.pl unixbench.folded >unixbench.svg\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("将unixbench.svg下载windows后, 浏览器打开即可"),s("br"),e._v("\n查看最后效果.")])])]),e._v(" "),s("p",[s("img",{attrs:{src:"https://s4.51cto.com/images/blog/202009/11/d0d5067793243a5a9db346c3098deba6.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=",alt:""}})])])}),[],!1,null,null,null);a.default=n.exports}}]);
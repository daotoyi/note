(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{582:function(a,s,e){"use strict";e.r(s);var t=e(20),l=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("p",[a._v("Linux_pam.d/faillock")]),a._v(" "),e("h1",{attrs:{id:"导言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导言"}},[a._v("#")]),a._v(" 导言")]),a._v(" "),e("blockquote",[e("p",[a._v("Removed deprecated pam_tally and pam_tally2 modules, use pam_faillock instead.")])]),a._v(" "),e("h1",{attrs:{id:"建立存储目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#建立存储目录"}},[a._v("#")]),a._v(" 建立存储目录")]),a._v(" "),e("blockquote",[e("p",[a._v("mkdir /var/log/faillock")])]),a._v(" "),e("p",[a._v("faillock相关的信息会以用存储在这个目录下")]),a._v(" "),e("h1",{attrs:{id:"配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[a._v("#")]),a._v(" 配置")]),a._v(" "),e("ol",[e("li",[a._v("远程登录文件"),e("code",[a._v("/etc/pam.d/sshd")])])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("auth     requisite                    pam_faillock.so    preauth\nauth     [success=1 default=bad]      pam_unix.so        shadow nullok\nauth     [default=die]                pam_faillock.so    authfail\nauth     sufficient                   pam_faillock.so    authsucc\n\naccount    required     pam_unix.so shadow nullok\npassword   required     pam_unix.so shadow nullok\nsession    required     pam_unix.so shadow nullok\nsession    required     pam_loginuid.so\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br")])]),e("ul",[e("li",[a._v("success=1 表示此行成功后，跳过下面")]),a._v(" "),e("li",[a._v("default=die 表示之后的不执行了，因为succ成功后，会抹去登录失败的记录信息")])]),a._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[a._v("faillock配置文件"),e("code",[a._v("/etc/security/faillock.conf")])])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("dir = /var/log/faillock\ndeny = 5\nfail_interval = 180\nunlock_time = 600\n\neven_deny_root\t\t# root也受限\nroot_unlock_time = 60\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br")])]),e("h1",{attrs:{id:"测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[a._v("#")]),a._v(" 测试")]),a._v(" "),e("p",[e("code",[a._v("faillock --dir /var/log/faillock --user root")])]),a._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("faillock --dir /var/log/faillock --user root\nroot:\nWhen                Type  Source                                           Valid\n2021-04-21 09:49:49 RHOST 172.16.254.216                                       V\n2021-04-21 09:49:52 RHOST 172.16.254.216                                       V\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br")])]),e("ul",[e("li",[a._v("v表示有效，i表示无效")])]),a._v(" "),e("h1",{attrs:{id:"faillock命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#faillock命令"}},[a._v("#")]),a._v(" faillock命令")]),a._v(" "),e("blockquote",[e("p",[a._v("faillock --reset\t# 解锁所有用户\nfaillock --user root --reset\t# 解锁一个用户账户")])])])}),[],!1,null,null,null);s.default=l.exports}}]);
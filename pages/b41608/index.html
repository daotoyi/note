<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx通识 | 道一站</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/tea.ico">
    <meta name="description" content="读书, 笔记, 博客">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.5724d9fb.css" as="style"><link rel="preload" href="/assets/js/app.b66476c8.js" as="script"><link rel="preload" href="/assets/js/2.9660e207.js" as="script"><link rel="preload" href="/assets/js/113.26b3ccb8.js" as="script"><link rel="prefetch" href="/assets/js/10.b6e0e2e2.js"><link rel="prefetch" href="/assets/js/100.9a339e0f.js"><link rel="prefetch" href="/assets/js/101.aa01c979.js"><link rel="prefetch" href="/assets/js/102.c58276fc.js"><link rel="prefetch" href="/assets/js/103.fecd03e0.js"><link rel="prefetch" href="/assets/js/104.ebe29dbc.js"><link rel="prefetch" href="/assets/js/105.67e38440.js"><link rel="prefetch" href="/assets/js/106.3beb66e8.js"><link rel="prefetch" href="/assets/js/107.e1a38a04.js"><link rel="prefetch" href="/assets/js/108.5e75b1e4.js"><link rel="prefetch" href="/assets/js/109.30864519.js"><link rel="prefetch" href="/assets/js/11.67494da9.js"><link rel="prefetch" href="/assets/js/110.e5a43c19.js"><link rel="prefetch" href="/assets/js/111.b84178ee.js"><link rel="prefetch" href="/assets/js/112.492369ce.js"><link rel="prefetch" href="/assets/js/114.b4ac31ed.js"><link rel="prefetch" href="/assets/js/115.c5406c76.js"><link rel="prefetch" href="/assets/js/116.d13f1dc0.js"><link rel="prefetch" href="/assets/js/117.5f748462.js"><link rel="prefetch" href="/assets/js/118.787ae3a9.js"><link rel="prefetch" href="/assets/js/119.7266a35c.js"><link rel="prefetch" href="/assets/js/12.ca913285.js"><link rel="prefetch" href="/assets/js/120.0b9c6f8b.js"><link rel="prefetch" href="/assets/js/121.38b844c5.js"><link rel="prefetch" href="/assets/js/122.4efeebe7.js"><link rel="prefetch" href="/assets/js/123.524f0b15.js"><link rel="prefetch" href="/assets/js/124.b5f7ab88.js"><link rel="prefetch" href="/assets/js/125.05b1f607.js"><link rel="prefetch" href="/assets/js/126.6bd9c5d8.js"><link rel="prefetch" href="/assets/js/127.a68347a3.js"><link rel="prefetch" href="/assets/js/128.2f69ceac.js"><link rel="prefetch" href="/assets/js/129.9685f8fa.js"><link rel="prefetch" href="/assets/js/13.a47eab5c.js"><link rel="prefetch" href="/assets/js/130.4932cdbc.js"><link rel="prefetch" href="/assets/js/131.efbdcbf9.js"><link rel="prefetch" href="/assets/js/132.9cf45a52.js"><link rel="prefetch" href="/assets/js/133.415ddbbb.js"><link rel="prefetch" href="/assets/js/134.f979772d.js"><link rel="prefetch" href="/assets/js/135.018e82ae.js"><link rel="prefetch" href="/assets/js/136.18e6a51c.js"><link rel="prefetch" href="/assets/js/137.bdf58b34.js"><link rel="prefetch" href="/assets/js/138.a7070fe6.js"><link rel="prefetch" href="/assets/js/139.4b73c696.js"><link rel="prefetch" href="/assets/js/14.559224b0.js"><link rel="prefetch" href="/assets/js/140.be890bef.js"><link rel="prefetch" href="/assets/js/141.bd8f78d0.js"><link rel="prefetch" href="/assets/js/142.bee8c897.js"><link rel="prefetch" href="/assets/js/143.9d60fb09.js"><link rel="prefetch" href="/assets/js/144.17abc3b8.js"><link rel="prefetch" href="/assets/js/145.d03f52ed.js"><link rel="prefetch" href="/assets/js/146.50a65762.js"><link rel="prefetch" href="/assets/js/147.38fef13c.js"><link rel="prefetch" href="/assets/js/148.b323e6ac.js"><link rel="prefetch" href="/assets/js/149.dd26fefc.js"><link rel="prefetch" href="/assets/js/15.fa8e8919.js"><link rel="prefetch" href="/assets/js/150.e7d43967.js"><link rel="prefetch" href="/assets/js/151.e41b15da.js"><link rel="prefetch" href="/assets/js/152.d0433252.js"><link rel="prefetch" href="/assets/js/153.db8f6165.js"><link rel="prefetch" href="/assets/js/154.87e44fbb.js"><link rel="prefetch" href="/assets/js/155.6ed00e4f.js"><link rel="prefetch" href="/assets/js/156.00d5d521.js"><link rel="prefetch" href="/assets/js/157.23bf5be1.js"><link rel="prefetch" href="/assets/js/158.1620edd1.js"><link rel="prefetch" href="/assets/js/159.b551b25d.js"><link rel="prefetch" href="/assets/js/16.0cae564c.js"><link rel="prefetch" href="/assets/js/160.d42fb55e.js"><link rel="prefetch" href="/assets/js/161.4d716e3c.js"><link rel="prefetch" href="/assets/js/162.c66e9a71.js"><link rel="prefetch" href="/assets/js/163.38f00a8f.js"><link rel="prefetch" href="/assets/js/164.fb95b941.js"><link rel="prefetch" href="/assets/js/165.f86851e9.js"><link rel="prefetch" href="/assets/js/166.37bfd629.js"><link rel="prefetch" href="/assets/js/167.2f7953d1.js"><link rel="prefetch" href="/assets/js/168.a7473a98.js"><link rel="prefetch" href="/assets/js/169.1697cf96.js"><link rel="prefetch" href="/assets/js/17.0e3baa17.js"><link rel="prefetch" href="/assets/js/170.93b0425a.js"><link rel="prefetch" href="/assets/js/171.c5387a09.js"><link rel="prefetch" href="/assets/js/172.0cdbf3ac.js"><link rel="prefetch" href="/assets/js/173.896cd497.js"><link rel="prefetch" href="/assets/js/174.035a2d6d.js"><link rel="prefetch" href="/assets/js/175.02262bc6.js"><link rel="prefetch" href="/assets/js/176.f874684b.js"><link rel="prefetch" href="/assets/js/177.186e478a.js"><link rel="prefetch" href="/assets/js/178.39cb3c14.js"><link rel="prefetch" href="/assets/js/18.90c821eb.js"><link rel="prefetch" href="/assets/js/19.55601596.js"><link rel="prefetch" href="/assets/js/20.934844bb.js"><link rel="prefetch" href="/assets/js/21.91e345dd.js"><link rel="prefetch" href="/assets/js/22.b00bf8ed.js"><link rel="prefetch" href="/assets/js/23.6b15e7bd.js"><link rel="prefetch" href="/assets/js/24.f44937fd.js"><link rel="prefetch" href="/assets/js/25.13169876.js"><link rel="prefetch" href="/assets/js/26.f9301c8e.js"><link rel="prefetch" href="/assets/js/27.5e9ccef7.js"><link rel="prefetch" href="/assets/js/28.6ed5276a.js"><link rel="prefetch" href="/assets/js/29.fdf0be9b.js"><link rel="prefetch" href="/assets/js/3.50544697.js"><link rel="prefetch" href="/assets/js/30.2080657a.js"><link rel="prefetch" href="/assets/js/31.2e51fdfa.js"><link rel="prefetch" href="/assets/js/32.ecd6afbb.js"><link rel="prefetch" href="/assets/js/33.9ade7547.js"><link rel="prefetch" href="/assets/js/34.9cc0e5fb.js"><link rel="prefetch" href="/assets/js/35.fa4b1bfa.js"><link rel="prefetch" href="/assets/js/36.18939ea0.js"><link rel="prefetch" href="/assets/js/37.1fd08f75.js"><link rel="prefetch" href="/assets/js/38.1bd82a55.js"><link rel="prefetch" href="/assets/js/39.d7d50aee.js"><link rel="prefetch" href="/assets/js/4.7f859c55.js"><link rel="prefetch" href="/assets/js/40.01d90194.js"><link rel="prefetch" href="/assets/js/41.c5c77bf5.js"><link rel="prefetch" href="/assets/js/42.eebea94c.js"><link rel="prefetch" href="/assets/js/43.b5c82a58.js"><link rel="prefetch" href="/assets/js/44.3c17793a.js"><link rel="prefetch" href="/assets/js/45.83d81bd0.js"><link rel="prefetch" href="/assets/js/46.7460772e.js"><link rel="prefetch" href="/assets/js/47.23acd564.js"><link rel="prefetch" href="/assets/js/48.58b56334.js"><link rel="prefetch" href="/assets/js/49.34f2a3fe.js"><link rel="prefetch" href="/assets/js/5.dad9c1b7.js"><link rel="prefetch" href="/assets/js/50.f3cbb0af.js"><link rel="prefetch" href="/assets/js/51.fe7d9f67.js"><link rel="prefetch" href="/assets/js/52.92bbcc45.js"><link rel="prefetch" href="/assets/js/53.541a93da.js"><link rel="prefetch" href="/assets/js/54.83c15585.js"><link rel="prefetch" href="/assets/js/55.c7aa6a16.js"><link rel="prefetch" href="/assets/js/56.402a94ca.js"><link rel="prefetch" href="/assets/js/57.95c50996.js"><link rel="prefetch" href="/assets/js/58.ca8d94c5.js"><link rel="prefetch" href="/assets/js/59.84291497.js"><link rel="prefetch" href="/assets/js/6.ea31d6f3.js"><link rel="prefetch" href="/assets/js/60.8c7d7d93.js"><link rel="prefetch" href="/assets/js/61.2fe78e6f.js"><link rel="prefetch" href="/assets/js/62.ef04ca42.js"><link rel="prefetch" href="/assets/js/63.a9ca66bd.js"><link rel="prefetch" href="/assets/js/64.67bb7412.js"><link rel="prefetch" href="/assets/js/65.450a4fe9.js"><link rel="prefetch" href="/assets/js/66.cee89042.js"><link rel="prefetch" href="/assets/js/67.f3bfb57a.js"><link rel="prefetch" href="/assets/js/68.708dd2ec.js"><link rel="prefetch" href="/assets/js/69.3648bb92.js"><link rel="prefetch" href="/assets/js/7.17f26569.js"><link rel="prefetch" href="/assets/js/70.f8175124.js"><link rel="prefetch" href="/assets/js/71.dc35fcbb.js"><link rel="prefetch" href="/assets/js/72.7aabdfac.js"><link rel="prefetch" href="/assets/js/73.dc2da581.js"><link rel="prefetch" href="/assets/js/74.af811184.js"><link rel="prefetch" href="/assets/js/75.62228fc9.js"><link rel="prefetch" href="/assets/js/76.fb6facba.js"><link rel="prefetch" href="/assets/js/77.7f4f3b3f.js"><link rel="prefetch" href="/assets/js/78.22b17ecc.js"><link rel="prefetch" href="/assets/js/79.61a76361.js"><link rel="prefetch" href="/assets/js/8.939810a1.js"><link rel="prefetch" href="/assets/js/80.85818678.js"><link rel="prefetch" href="/assets/js/81.8bbc4948.js"><link rel="prefetch" href="/assets/js/82.eca3852c.js"><link rel="prefetch" href="/assets/js/83.f9d685e1.js"><link rel="prefetch" href="/assets/js/84.9c4698ac.js"><link rel="prefetch" href="/assets/js/85.06ce96fd.js"><link rel="prefetch" href="/assets/js/86.a3b044ca.js"><link rel="prefetch" href="/assets/js/87.20e0373c.js"><link rel="prefetch" href="/assets/js/88.b740bbe8.js"><link rel="prefetch" href="/assets/js/89.c3b7c36d.js"><link rel="prefetch" href="/assets/js/9.328576c6.js"><link rel="prefetch" href="/assets/js/90.89247fc1.js"><link rel="prefetch" href="/assets/js/91.e587de7b.js"><link rel="prefetch" href="/assets/js/92.7707868e.js"><link rel="prefetch" href="/assets/js/93.890b8b39.js"><link rel="prefetch" href="/assets/js/94.c21407bd.js"><link rel="prefetch" href="/assets/js/95.4f43b38a.js"><link rel="prefetch" href="/assets/js/96.a8ff9d1a.js"><link rel="prefetch" href="/assets/js/97.6ec8993c.js"><link rel="prefetch" href="/assets/js/98.fb6437e9.js"><link rel="prefetch" href="/assets/js/99.d8f1dfb7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5724d9fb.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="道一站" class="logo"> <span class="site-name can-hide">道一站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="阅读" class="dropdown-title"><a href="/read/" class="link-title">阅读</a> <span class="title" style="display:none;">阅读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9931f7/" class="nav-link">自我管理</a></li><li class="dropdown-item"><!----> <a href="/pages/3cfee2/" class="nav-link">李笑来</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="投资" class="dropdown-title"><a href="/invest/" class="link-title">投资</a> <span class="title" style="display:none;">投资</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">股票</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">期货</a></li><li class="dropdown-item"><!----> <a href="/pages/16f920/" class="nav-link">期权</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">量化</a></li><li class="dropdown-item"><!----> <a href="/pages/832bd7/" class="nav-link">区块</a></li><li class="dropdown-item"><!----> <a href="/pages/660ab0/" class="nav-link">认知</a></li><li class="dropdown-item"><!----> <a href="/pages/02697b/" class="nav-link">收藏</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li><li class="dropdown-item"><h4>编程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6a18d2/" class="nav-link">Python</a></li><li class="dropdown-subitem"><a href="/pages/f955bf/" class="nav-link">Shell</a></li><li class="dropdown-subitem"><a href="/code/wx-miniprogram/" class="nav-link">小程序笔记</a></li></ul></li><li class="dropdown-item"><h4>笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e.html" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/aaa17a/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/3c8281/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏资源</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>daotoyi</h3> <span>静水流深</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="阅读" class="dropdown-title"><a href="/read/" class="link-title">阅读</a> <span class="title" style="display:none;">阅读</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9931f7/" class="nav-link">自我管理</a></li><li class="dropdown-item"><!----> <a href="/pages/3cfee2/" class="nav-link">李笑来</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="投资" class="dropdown-title"><a href="/invest/" class="link-title">投资</a> <span class="title" style="display:none;">投资</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">股票</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">期货</a></li><li class="dropdown-item"><!----> <a href="/pages/16f920/" class="nav-link">期权</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">量化</a></li><li class="dropdown-item"><!----> <a href="/pages/832bd7/" class="nav-link">区块</a></li><li class="dropdown-item"><!----> <a href="/pages/660ab0/" class="nav-link">认知</a></li><li class="dropdown-item"><!----> <a href="/pages/02697b/" class="nav-link">收藏</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/pages/51afd6/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>页面</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li></ul></li><li class="dropdown-item"><h4>编程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6a18d2/" class="nav-link">Python</a></li><li class="dropdown-subitem"><a href="/pages/f955bf/" class="nav-link">Shell</a></li><li class="dropdown-subitem"><a href="/code/wx-miniprogram/" class="nav-link">小程序笔记</a></li></ul></li><li class="dropdown-item"><h4>笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">《JavaScript教程》</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">《JavaScript高级程序设计》</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">《Git》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/9a7ee40fc232253e.html" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/aaa17a/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/3c8281/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/4c778760be26d8b3/" class="nav-link">GitHub</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏资源</a></li><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习方法</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技术文档</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/7c6b75/" class="sidebar-link">127001和0000地址的区别</a></li><li><a href="/pages/9d48ef/" class="sidebar-link">arp_route</a></li><li><a href="/pages/f867c5/" class="sidebar-link">CMD_ip_ifconfig</a></li><li><a href="/pages/aaa17a/" class="sidebar-link">IP与子网掩码的关系</a></li><li><a href="/pages/a1eea3/" class="sidebar-link">libc，glibc和libc关系</a></li><li><a href="/pages/f7508d/" class="sidebar-link">Linux 路由表详解及 route 命令详解</a></li><li><a href="/pages/4d387e/" class="sidebar-link">Linux 系统中成功恢复已删除的文件</a></li><li><a href="/pages/a213aa/" class="sidebar-link">Linux_boot</a></li><li><a href="/pages/696eee/" class="sidebar-link">Linux_chroot</a></li><li><a href="/pages/8c6bc1/" class="sidebar-link">Linux_chroot_RecoveryPass</a></li><li><a href="/pages/6e788e/" class="sidebar-link">Linux_chroot_SSHlogin</a></li><li><a href="/pages/49f694/" class="sidebar-link">Linux_cmd_echo</a></li><li><a href="/pages/fcfbc2/" class="sidebar-link">LInux_cmd_sed</a></li><li><a href="/pages/bdfe9e/" class="sidebar-link">Linux_FTP</a></li><li><a href="/pages/463653/" class="sidebar-link">Linux_ldconfig_PATH</a></li><li><a href="/pages/97e68f/" class="sidebar-link">Linux_locale</a></li><li><a href="/pages/397d5b/" class="sidebar-link">Linux_Login_Repeat</a></li><li><a href="/pages/f956b6/" class="sidebar-link">d_faillock</a></li><li><a href="/pages/43df05/" class="sidebar-link">Linux_SSH</a></li><li><a href="/pages/4dd4be/" class="sidebar-link">Linux_systemctl_systemd</a></li><li><a href="/pages/af92a6/" class="sidebar-link">Linux_systemd_serivice</a></li><li><a href="/pages/e0481b/" class="sidebar-link">Linux_Terminal_HotKey</a></li><li><a href="/pages/388e94/" class="sidebar-link">Linux-cmd-tar</a></li><li><a href="/pages/f3a576/" class="sidebar-link">LinuxTerminalHotkey</a></li><li><a href="/pages/b3c12c/" class="sidebar-link">linux后台运行、挂起、恢复进程相关命令</a></li><li><a href="/pages/b16d2b/" class="sidebar-link">Linux认证</a></li><li><a href="/pages/87ab67/" class="sidebar-link">Net</a></li><li><a href="/pages/cec7fa/" class="sidebar-link">Nginx 常用配置清单</a></li><li><a href="/pages/b41608/" aria-current="page" class="active sidebar-link">Nginx通识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/b41608/#excerpt" class="sidebar-link">Excerpt</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx-简介" class="sidebar-link">Nginx 简介</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_1-1-web-服务器" class="sidebar-link">1.1 WEB 服务器</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_1-2-反向代理" class="sidebar-link">1.2 反向代理</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_1-3-负载均衡" class="sidebar-link">1.3 负载均衡</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_1-4-动静分离" class="sidebar-link">1.4 动静分离</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#安装启动" class="sidebar-link">安装启动</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_2-1-相关安装包" class="sidebar-link">2.1 相关安装包</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_2-2-安装流程" class="sidebar-link">2.2 安装流程</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#_2-3-nginx-启动" class="sidebar-link">2.3 Nginx 启动</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx核心配置文件" class="sidebar-link">Nginx核心配置文件</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#第一部分-全局块" class="sidebar-link">第一部分：全局块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#第二部分-events-块" class="sidebar-link">第二部分：events 块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#第三部分-http-块" class="sidebar-link">第三部分：http 块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#http-全局块" class="sidebar-link">http 全局块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#server-块" class="sidebar-link">server 块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#全局-server-块" class="sidebar-link">全局 server 块</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#location-块" class="sidebar-link">location 块</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx配置实战-反向代理" class="sidebar-link">Nginx配置实战-反向代理</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx配置实战-负载均衡" class="sidebar-link">Nginx配置实战-负载均衡</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#轮询-默认" class="sidebar-link">轮询（默认）</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#weight" class="sidebar-link">weight</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#ip-hash" class="sidebar-link">ip_hash</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#fair-第三方" class="sidebar-link">fair（第三方）</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx-配置实战-动静分离" class="sidebar-link">Nginx 配置实战-动静分离</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx-原理与优化参数配置" class="sidebar-link">Nginx 原理与优化参数配置</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#master-workers-的机制的好处" class="sidebar-link">master-workers 的机制的好处</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#需要设置多少个-worker" class="sidebar-link">需要设置多少个 worker</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#连接数-worker-connection" class="sidebar-link">连接数 worker_connection</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#nginx-搭建高可用集群" class="sidebar-link">nginx 搭建高可用集群</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#keepalived-nginx-高可用集群-主从模式" class="sidebar-link">Keepalived+Nginx 高可用集群（主从模式）</a></li><li class="sidebar-sub-header level4"><a href="/pages/b41608/#keepalived-nginx-高可用集群-双主模式" class="sidebar-link">Keepalived+Nginx 高可用集群（双主模式）</a></li><li class="sidebar-sub-header level3"><a href="/pages/b41608/#推荐阅读" class="sidebar-link">推荐阅读</a></li></ul></li></ul></li><li><a href="/pages/2e9c40/" class="sidebar-link">perf分析unixbench性能</a></li><li><a href="/pages/361c70/" class="sidebar-link">ping请求错误分析</a></li><li><a href="/pages/b1b6b1/" class="sidebar-link">Remote_SSH&amp;X11(Manjaro)</a></li><li><a href="/pages/bcd9df/" class="sidebar-link">6)</a></li><li><a href="/pages/deb210/" class="sidebar-link">Sql Or NoSql，看完这一篇你就懂了</a></li><li><a href="/pages/95767f/" class="sidebar-link">systemd</a></li><li><a href="/pages/92ec8a/" class="sidebar-link">Unicode_UTF</a></li><li><a href="/pages/6fb387/" class="sidebar-link">URL</a></li><li><a href="/pages/506510/" class="sidebar-link">开源协议</a></li><li><a href="/pages/342878/" class="sidebar-link">线程、进程、多线程、多进程和多任务</a></li><li><a href="/pages/cdac11/" class="sidebar-link">正向代理与反向代理</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GitHub</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博客搭建</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>效用工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/technology/#技术" data-v-0c557b5e>技术</a></li><li data-v-0c557b5e><a href="/technology/#Linux" data-v-0c557b5e>Linux</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>步尔斯特</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-04-30</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Nginx通识<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="一把王者的时间-我就学会了-nginx"><a href="#一把王者的时间-我就学会了-nginx" class="header-anchor">#</a> 一把王者的时间，我就学会了 Nginx！</h1> <blockquote><h2 id="excerpt"><a href="#excerpt" class="header-anchor">#</a> Excerpt</h2> <p>在下方公众号后台回复：JGNB，可获取杰哥原创的 PDF 手册。</p></blockquote> <hr> <p>在下方公众号后台回复：<strong>JGNB</strong>，可获取杰哥原创的 PDF 手册。</p> <h3 id="nginx-简介"><a href="#nginx-简介" class="header-anchor">#</a> Nginx 简介</h3> <p>Nginx(&quot;engine x&quot;)是一个高性能的 HTTP 和反向代理服务器,特点是占有内存少，并发能力强，事实上 nginx 的并发能力确实在同类型的网页服务器中表现较好，中国大陆使用 nginx 网站用户有：百度、京东、新浪、网易、腾讯、 淘宝等。</p> <h4 id="_1-1-web-服务器"><a href="#_1-1-web-服务器" class="header-anchor">#</a> 1.1 WEB 服务器</h4> <p>Nginx 可以作为静态页面的 web 服务器，同时还支持 CGI 协议的动态语言，比如 perl、php等。但是不支持 java。Java 程序只能通过与 tomcat 配合完成。Nginx 专为性能优化而开发，性能是其最重要的考量,实现上非常注重效率 ，能经受高负载的考验,有报告表明能支持高达 50000个并发连接数。</p> <h4 id="_1-2-反向代理"><a href="#_1-2-反向代理" class="header-anchor">#</a> 1.2 反向代理</h4> <ul><li><p>正向代理，代理客户端，客户端需要配置代理</p></li> <li><p>反向代理，代理服务端，客户端无感知</p></li></ul> <h4 id="_1-3-负载均衡"><a href="#_1-3-负载均衡" class="header-anchor">#</a> 1.3 负载均衡</h4> <p>Nginx 的异步框架可以处理很大的并发请求，把这些并发请求 hold 住之后就可以分发给后台服务端(backend servers，也叫做服务池， 后面简称 backend)来做复杂的计算、处理和响应，这种模式的好处是相当多的：隐藏业务主机更安全，节约了公网 IP 地址，并且在业务量增加的时候可以方便地扩容后台服务器。</p> <p>这时候集群的概念产生了，我们增加服务器的数量，然后将请求分发到各个服务器上，将原先请求集中到单个服务器上的情况改为将请求分发到多个服务器上，将负载分发到不同的服器，也就是我们所说的负载均衡。</p> <h4 id="_1-4-动静分离"><a href="#_1-4-动静分离" class="header-anchor">#</a> 1.4 动静分离</h4> <p>为了加快网站的解析速度，可以把动态页面和静态页面由不同的服务器来解析，加快解析速度。降低原来单个服务器的压力。</p> <p>Nginx部署静态资源，tomcat部署动态资源</p> <h3 id="安装启动"><a href="#安装启动" class="header-anchor">#</a> 安装启动</h3> <h4 id="_2-1-相关安装包"><a href="#_2-1-相关安装包" class="header-anchor">#</a> 2.1 相关安装包</h4> <p>pcre-8.37.tar.gz</p> <p>openssl-1.0.1t.tar.gz</p> <p>zlib-1.2.8.tar.gz</p> <p>nginx-1.11.1.tar.gz</p> <h4 id="_2-2-安装流程"><a href="#_2-2-安装流程" class="header-anchor">#</a> 2.2 安装流程</h4> <p>1.安装 pcre 解压缩 pcre-xx.tar.gz 包</p> <p>进入解压缩目录，执行./configure</p> <p>如果提示，需要提前安装 gcc++，进入安装光盘目录的软件包(/media/CentOSXX/Package)执行</p> <ul><li><p>rpm -ivh libstdc+±devel-4.4.7-17.el6.x86_64.rpm</p></li> <li><p>rpm -ivh gcc-c+±4.4.7-17.el6.x86_64.rpm</p></li></ul> <p>./configure 完成后，回到 pcre 目录下执行 make，再执行 make install</p> <p>2.安装 openssl</p> <p>解压缩 openssl-xx.tar.gz 包，进入解压缩目录，执行./config</p> <p>make &amp;&amp; make install</p> <p>3.安装 zlib 解压缩 zlib-xx.tar.gz 包，进入解压缩目录，执行./configure。</p> <p>make &amp;&amp; make install</p> <p>4.安装 nginx</p> <p>解压缩 nginx-xx.tar.gz 包，进入解压缩目录，执行./configure。</p> <p>make &amp;&amp; make install</p> <p>查看开放的端口号</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>firewall-cmd --list-all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设置开放的端口号</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>firewall-cmd --add-service=http –permanentsudo firewall-cmd --add-port=80/tcp --permanent
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>重启防火墙</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>firewall-cmd –reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-3-nginx-启动"><a href="#_2-3-nginx-启动" class="header-anchor">#</a> 2.3 Nginx 启动</h4> <p>命令</p> <ul><li><p>启动命令：在/usr/local/nginx/sbin 目录下执行 ./nginx</p></li> <li><p>关闭命令: 在/usr/local/nginx/sbin 目录下执行 ./nginx -s stop</p></li> <li><p>重新加载命令: 在/usr/local/nginx/sbin 目录下执行 ./nginx -s reload·</p></li></ul> <p>设置 nginx 为自启动服务</p> <ul><li><p>修改 linux 启动脚本/etc/rc.d/rc</p></li> <li><p>加入 :/usr/local/nginx/sbin/nginx</p></li></ul> <h3 id="nginx核心配置文件"><a href="#nginx核心配置文件" class="header-anchor">#</a> Nginx核心配置文件</h3> <p>nginx 安装目录下，其默认的配置文件都放在conf 目录下，而主配置文件nginx.conf 也在其中，后续对 nginx 的使用基本上都是对此配置文件进行相应的修改。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>worker_processes  1;events {    worker_connections  1024;}http {    include       mime.types;    default_type  application/octet-stream;    keepalive_timeout  65;    server {        listen       80;        server_name  localhost;        location / {            root   html;            index  index.html index.htm;        }    } }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>根据上述文件，我们可以很明显的将 nginx.conf 配置文件分为三部分</p> <h4 id="第一部分-全局块"><a href="#第一部分-全局块" class="header-anchor">#</a> 第一部分：全局块</h4> <p>从配置文件开始到 events 块之间的内容，主要会设置一些影响 nginx 服务器整体运行的配置指令，主要包括配置运行 Nginx 服务器的用户（组）、允许生成的 worker process 数，进程 PID 存放路径、日志存放路径和类型以及配置文件的引入等。</p> <p>比如上面第一行配置的：worker_processes 1;</p> <p>这是 Nginx 服务器并发处理服务的关键配置，worker_processes 值越大，可以支持的并发处理量也越多，但是会受到硬件、软件等设备的制约。</p> <h4 id="第二部分-events-块"><a href="#第二部分-events-块" class="header-anchor">#</a> 第二部分：events 块</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>events {    worker_connections  1024;}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>events 块涉及的指令主要影响 Nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 work process 下的网络连接进行序列化，是否允许同时接收多个网络连接，选取哪种事件驱动模型来处理连接请求，每个 word process 可以同时支持的最大连接数等。</p> <p>上述例子就表示每个 work process 支持的最大连接数为 1024.</p> <p>这部分的配置对 Nginx 的性能影响较大，在实际中应该灵活配置。</p> <h4 id="第三部分-http-块"><a href="#第三部分-http-块" class="header-anchor">#</a> 第三部分：http 块</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>http {    include       mime.types;    default_type  application/octet-stream;    keepalive_timeout  65;    server {        listen       80;        server_name  localhost;        location / {            root   html;            index  index.html index.htm;        }    } }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这算是 Nginx 服务器配置中最频繁的部分，代理、缓存和日志定义等绝大多数功能和第三方模块的配置都在这里。</p> <p>需要注意的是：http 块也可以包括 http 全局块、server 块。</p> <h4 id="http-全局块"><a href="#http-全局块" class="header-anchor">#</a> http 全局块</h4> <p>http 全局块配置的指令包括文件引入、MIME-TYPE 定义、日志自定义、连接超时时间、单链接请求数上限等。</p> <h4 id="server-块"><a href="#server-块" class="header-anchor">#</a> server 块</h4> <p>这块和虚拟主机有密切关系，虚拟主机从用户角度看，和一台独立的硬件主机是完全一样的，该技术的产生是为了节省互联网服务器硬件成本。</p> <p>每个 http 块可以包括多个 server 块，而每个 server 块就相当于一个虚拟主机。</p> <p>而每个 server 块也分为全局 server 块，以及可以同时包含多个 locaton 块。</p> <h4 id="全局-server-块"><a href="#全局-server-块" class="header-anchor">#</a> 全局 server 块</h4> <p>最常见的配置是本虚拟机主机的监听配置和本虚拟主机的名称或 IP 配置。</p> <h4 id="location-块"><a href="#location-块" class="header-anchor">#</a> location 块</h4> <p>一个 server 块可以配置多个 location 块。</p> <p>这块的主要作用是基于 Nginx 服务器接收到的请求字符串（例如 server_name/uri-string），对虚拟主机名称（也可以是 IP 别名）之外的字符串（例如 前面的 /uri-string）进行匹配，对特定的请求进行处理。地址定向、数据缓存和应答控制等功能，还有许多第三方模块的配置也在这里进行。</p> <h3 id="nginx配置实战-反向代理"><a href="#nginx配置实战-反向代理" class="header-anchor">#</a> Nginx配置实战-反向代理</h3> <p>案例配置如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>server {        listen       80;        server_name  localhost;        location / {            proxy_pass http://localhost:8001;        }        location ~ /demo1 {            proxy_pass http://localhost:8001;        }        location ~ /demo2 {            proxy_pass http://localhost:8002;        }    }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>location 指令说明</strong></p> <p>该指令用于匹配 URL，语法如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>location [= | ~ | ~*| ^~] url{}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>= ：用于不含正则表达式的 uri 前，要求请求字符串与 uri 严格匹配，如果匹配成功，就停止继续向下搜索并立即处理该请求。</p></li> <li><p>~：用于表示 uri 包含正则表达式，并且区分大小写。</p></li> <li><p>~*：用于表示 uri 包含正则表达式，并且不区分大小写。</p></li> <li><p>^~：用于不含正则表达式的 uri 前，要求 Nginx 服务器找到标识 uri 和请求字符串匹配度最高的 location 后，立即使用此 location 处理请求，而不再使用 location 块中的正则 uri 和请求字符串做匹配。</p></li></ul> <p>注意：如果 uri 包含正则表达式，则必须要有 ~ 或者 ~* 标识。</p> <h3 id="nginx配置实战-负载均衡"><a href="#nginx配置实战-负载均衡" class="header-anchor">#</a> Nginx配置实战-负载均衡</h3> <p>案例配置如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http{  upstream myserver{    ip_hash;    server localhost:8080 weight=1;    server localhost:8081 weight=1;  }    server {        listen       80;        server_name  localhost;        location / {            proxy_pass http://myserver            proxy_connect_timeout 10;        }    }}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在 linux 下有 Nginx、LVS、Haproxy 等等服务可以提供负载均衡服务，而且 Nginx 提供了几种分配方式(策略)：</p> <h4 id="轮询-默认"><a href="#轮询-默认" class="header-anchor">#</a> 轮询（默认）</h4> <p>每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器 down 掉，能自动剔除。</p> <h4 id="weight"><a href="#weight" class="header-anchor">#</a> weight</h4> <p>weight 代表权重，默认为 1，权重越高被分配的客户端越多指定轮询机率，weight 和访问比率成正比，用于后端服务器性能不均的情况。</p> <h4 id="ip-hash"><a href="#ip-hash" class="header-anchor">#</a> ip_hash</h4> <p>每个请求按访问 ip 的 hash 结果分配，这样每个访客固定访问一个后端服务器，可以解决 session 的问题。</p> <h4 id="fair-第三方"><a href="#fair-第三方" class="header-anchor">#</a> fair（第三方）</h4> <p>按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p> <h3 id="nginx-配置实战-动静分离"><a href="#nginx-配置实战-动静分离" class="header-anchor">#</a> Nginx 配置实战-动静分离</h3> <p>动静分离从目前实现角度来讲大致分为两种：</p> <ul><li><p>一种是纯粹把静态文件独立成单独的域名，放在独立的服务器上，也是目前主流推崇的方案；</p></li> <li><p>另外一种方法就是动态跟静态文件混合在一起发布，通过 nginx 来分开。</p></li></ul> <p>通过 location 指定不同的后缀名实现不同的请求转发。通过 expires 参数设置，可以使浏览器缓存过期时间，减少与服务器之前的请求和流量。具体 Expires 定义：是给一个资源设定一个过期时间，也就是说无需去服务端验证，直接通过浏览器自身确认是否过期即可，所以不会产生额外的流量。此种方法非常适合不经常变动的资源。（如果经常更新的文件，不建议使用 Expires 来缓存），我这里设置 3d，表示在这 3 天之内访问这个 URL，发送一个请求，比对服务器该文件最后更新时间没有变化，则不会从服务器抓取，返回状态码304，如果有修改，则直接从服务器重新下载，返回状态码 200。</p> <h3 id="nginx-原理与优化参数配置"><a href="#nginx-原理与优化参数配置" class="header-anchor">#</a> Nginx 原理与优化参数配置</h3> <p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片"></p> <h4 id="master-workers-的机制的好处"><a href="#master-workers-的机制的好处" class="header-anchor">#</a> master-workers 的机制的好处</h4> <p>首先，对于每个 worker 进程来说，独立的进程，不需要加锁，所以省掉了锁带来的开销，同时在编程以及问题查找时，也会方便很多。其次，采用独立的进程，可以让互相之间不会影响，一个进程退出后，其它进程还在工作，服务不会中断，master 进程则很快启动新的 worker 进程。当然，worker 进程的异常退出，肯定是程序有 bug 了，异常退出，会导致当前 worker 上的所有请求失败，不过不会影响到所有请求，所以降低了风险。</p> <h4 id="需要设置多少个-worker"><a href="#需要设置多少个-worker" class="header-anchor">#</a> 需要设置多少个 worker</h4> <p>Nginx 同 redis 类似都采用了 io 多路复用机制，每个 worker 都是一个独立的进程，但每个进程里只有一个主线程，通过异步非阻塞的方式来处理请求， 即使是千上万个请求也不在话下。每个 worker 的线程可以把一个 cpu 的性能发挥到极致。所以 worker 数和服务器的 cpu 数相等是最为适宜的。设少了会浪费 cpu，设多了会造成 cpu 频繁切换上下文带来的损耗。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#设置 worker 数量。worker_processes 4#work 绑定 cpu(4 work 绑定 4cpu)。worker_cpu_affinity 0001 0010 0100 1000#work 绑定 cpu (4 work 绑定 8cpu 中的 4 个) 。worker_cpu_affinity 0000001 00000010 00000100 00001000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="连接数-worker-connection"><a href="#连接数-worker-connection" class="header-anchor">#</a> 连接数 worker_connection</h4> <p>这个值是表示每个 worker 进程所能建立连接的最大值，所以，一个 nginx 能建立的最大连接数，应该是 worker_connections * worker_processes。当然，这里说的是最大连接数，对于HTTP 请 求 本 地 资 源 来 说 ， 能 够 支 持 的 最 大 并 发 数 量 是 worker_connections * worker_processes，如果是支持 http1.1 的浏览器每次访问要占两个连接，所以普通的静态访问最大并发数是：worker_connections * worker_processes /2，而如果是 HTTP 作 为反向代理来说，最大并发数量应该是 worker_connections *</p> <p>worker_processes/4。因为作为反向代理服务器，每个并发会建立与客户端的连接和与后端服务的连接，会占用两个连接。</p> <p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片"></p> <h3 id="nginx-搭建高可用集群"><a href="#nginx-搭建高可用集群" class="header-anchor">#</a> nginx 搭建高可用集群</h3> <h4 id="keepalived-nginx-高可用集群-主从模式"><a href="#keepalived-nginx-高可用集群-主从模式" class="header-anchor">#</a> Keepalived+Nginx 高可用集群（主从模式）</h4> <p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="图片"></p> <h4 id="keepalived-nginx-高可用集群-双主模式"><a href="#keepalived-nginx-高可用集群-双主模式" class="header-anchor">#</a> Keepalived+Nginx 高可用集群（双主模式）</h4> <p><img src="https://mmbiz.qpic.cn/mmbiz_png/fXPe0HRL7DibdkHchHQldKSW2v3iarp5xsXcAvFdmyickF4MiaTtibRwGtjcgGga2FhWINKAYb5gG4mtPNibS4f5wzxw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p> <blockquote><p>作者 | 步尔斯特</p> <p>来源 | CSDN博客</p></blockquote> <h3 id="推荐阅读"><a href="#推荐阅读" class="header-anchor">#</a> 推荐阅读</h3> <p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjg1NjY3Nw==&amp;mid=2247526287&amp;idx=1&amp;sn=398ec553c58c7fb1b9cc14b1b42e0701&amp;chksm=9ac62405adb1ad137fbd8e08bf49a1b23d3ea57dead39e955c9f8231b1437f159da1c7027194&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Nginx 40 问！<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjg1NjY3Nw==&amp;mid=2247519578&amp;idx=2&amp;sn=47702cdb601cc3b7cae66f9c901e309e&amp;chksm=9ac6ced0adb147c64e6a5b7f8be1e0f45465fc4de3a4c3a6c95efd649c960cd985798ecbce94&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Nginx+Redis 高性能缓存利器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjg1NjY3Nw==&amp;mid=2247516246&amp;idx=2&amp;sn=0fb54bb89f7c1c53ccb16ae2311c3bdc&amp;chksm=9ac6c3dcadb14acaa303ffda61bb48d96be4c55887fb2aeaefa4b6d55a9a784f9bc85715ed71&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Nginx 挂了怎么办？怎么实现高可用？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjg1NjY3Nw==&amp;mid=2247515830&amp;idx=1&amp;sn=9ff91e36d87e4daf7e94f2a1233b0d4b&amp;chksm=9ac6fd3cadb1742aeff253ed2a6fa1fcff3b0655c02b46bfb1cc2aa4a6f9ba07f49da6c5d21c&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">彻底搞懂 Nginx 的五大应用场景<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjg1NjY3Nw==&amp;mid=2247515603&amp;idx=2&amp;sn=35dc8c4ab1b97dd492c04c64980b4d60&amp;chksm=9ac6fe59adb1774f990a6499ef3eddae53a7f71bd8e8fdf8a3786bdec353d0fa0a63a0a7f65e&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">Nginx 常用配置清单<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="https://mmbiz.qpic.cn/mmbiz_gif/nDMNE6lrvW7BKBskrjcw4QXRe4vRaBHS5HicrN8IkJdcJ8DnughguhlNia4iaD7G2A1gZMibQHhibiaJusIH611qbFGg/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" alt="图片"></p></div></div>  <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/07/06, 03:51:09</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/cec7fa/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Nginx 常用配置清单</div></a> <a href="/pages/2e9c40/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">perf分析unixbench性能</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/cec7fa/" class="prev">Nginx 常用配置清单</a></span> <span class="next"><a href="/pages/2e9c40/">perf分析unixbench性能</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/242b83/"><div>
            效率工具
            <!----></div></a> <span class="date">07-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/b0365e/"><div>
            网络资源
            <!----></div></a> <span class="date">07-06</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/140bd8/"><div>
            在线工具
            <!----></div></a> <span class="date">07-06</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:daotoyi@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/daotoyi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#" title="听音乐" target="_blank" class="iconfont icon-erji"></a><a href="https://daotoyi.cn/rss.xml" title="订阅" target="_blank" class="iconfont icon-rss"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>Daotoyi | <a href="https://github.com/daotoyi/site/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.b66476c8.js" defer></script><script src="/assets/js/2.9660e207.js" defer></script><script src="/assets/js/113.26b3ccb8.js" defer></script>
  </body>
</html>
